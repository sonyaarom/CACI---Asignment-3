pacman::p_load(reshape2, ggplot2, nnet, mclust, e1071, randomForest, cluster)
df_new <- read.csv("dataset_SK.csv")
pacman:: p_load(dplyr)
df_new

#Had to rename otherwise looks ugly, haha
names(df_new)[names(df_new)=="cluster_kmeans"]<- "Segment"
df_new

#Brief overview of the data set
unique(df_new$Segment)
summary(df_new)

#Sizes of obtained segments
table(df_new$Segment)

#Relative Frequency - Overall
ggplot(data = df_new) +
  geom_bar(mapping = aes(x = Segment, y = ..prop.., group = 1), stat = "count") +
  labs(y = "Relative Frequency") +
  scale_y_continuous(limits = c(0, 0.4)) +
  theme_classic()
#Grouped by level of education  
 ggplot(data = df_new, aes(x = Segment, y = ..prop.., group = 1)) +
  geom_bar(stat = "count") +
  labs(y = "Relative Frequency") +
  facet_wrap(.~Degree, ncol = 4) +
  theme_classic() +
  theme(axis.text.x = element_text(angle = 90)) 
#Grouped by level of income  
 ggplot(data = df_new, aes(x = Segment, y = ..prop.., group = 1)) +
  geom_bar(stat = "count") +
  labs(y = "Relative Frequency") +
  facet_wrap(.~Income, ncol = 5) +
  theme_classic() +
  theme(axis.text.x = element_text(angle = 90))   
#Grouped by Gender  
 ggplot(data = df_new, aes(x = Segment, y = ..prop.., group = 1)) +
  geom_bar(stat = "count") +
  labs(y = "Relative Frequency") +
  facet_wrap(.~Female, ncol = 2) +
  theme_classic() +
  theme(axis.text.x = element_text(angle = 90))   
  
  
  
#Splitting the data
set.seed(04625)   # fix the seed for reproducability
train.pop <- 0.60 
N <- nrow(df_new) 
train.cases <- sample(N, N*train.pop)
train.cases
df_new.train <- df_new[train.cases, ]
df_new.test <-df_new[-train.cases,]
df_new.train
df_new.test


#Training model
#Multinomial logistic regression - first attempt with all variables
logistic_all<-multinom(Segment~.,data=df_new.train)
summary(logistic_all)

#Neet to get rid of Id!



